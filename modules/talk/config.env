# --- Mia Talk defaults (launcher can override via ENV at runtime) ---

# Ollama
MIA_OLLAMA_HOST="http://127.0.0.1:11434"   # Ollama API Host
MIA_LLM="mia-talk-72b:latest"              # Modellname in Ollama
MIA_KEEPALIVE="-1m"                        # wie lange Modell im RAM bleiben soll (-1m) = für immer
MIA_WARMUP="1"                             # 1=Warmup Prompt schicken

# STT selection
MIA_STT_WAKE="tiny"                        # tiny für Wake-Erkennung (schnell)
MIA_STT_MAIN="large"                       # large für Haupttext (genauer)
MIA_WHISPER_LANG="de"                      # Sprache der Transkription

# Whisper paths
MIA_WHISPER_CLI="/data/mia/hear/whisper.cpp/build-cuda/bin/whisper-cli"
MIA_WHISPER_LARGE="/data/mia/hear/whisper.cpp/models/ggml-large-v3.bin"
MIA_AWAKE_TIMEOUT_SEC="180"

# VAD/Audio capture
MIA_RATE="16000"                           # Aufnahme Sample Rate
MIA_FRAME_MS="30"                          # VAD Frame-Länge (10/20/30 ms typisch)
MIA_VAD_MODE="2"                           # 0..3 aggressiv; 3 = sehr aggressiv (mehr Ghost / harte Cuts)
MIA_SILENCE_LIMIT_SEC="0.9"                # wie lange Stille bis "Speech Ende"
MIA_MIN_SPEECH_SEC="0.35"                  # zu kurze Aufnahmen ignorieren
MIA_TRIGGER_RATIO="0.70"                   # wieviel Speech im Ringbuffer bis Start
MIA_RING_MS="240"                          # Vorlaufpuffer (damit Anfang nicht abgeschnitten wird)
MIA_MAX_SEC="15"                           # maximale Aufnahme-Dauer

# Extra Noise-Gate
MIA_RMS_THRESHOLD="420"                    # wenn zu empfindlich: hoch (520), wenn zu taub: runter (320)

# Logs
MIA_LOG_DIR="/data/mia/memory/logs"
MIA_LOG_FILE=""                 # optional override; sonst $MIA_LOG_DIR/chat/chat.log

# Sessions
MIA_SESSION_DIR="/data/mia/memory/sessions"
MIA_SESSION_MODE="new"          # new|default|path
MIA_SESSION=""                  # wenn MODE=path: kompletter Pfad zur Session-Datei


# Wake/Exit
MIA_REQUIRE_WAKE="1"                       # 1 = nur reagieren wenn Wakeword erkannt wird
MIA_WAKEWORDS="hey mia, mia"               # Worte, die Mia aufwecken "aufwecken" (CSV)
MIA_EXITWORDS="mia ende"                   # Worte, die Mia beenden
MIA_AWAKE_TIMEOUT_SEC="180"

# Stop/Barge-in Wörter (CSV)
MIA_STOPWORDS="stop,stopp,pause,mia stop,mia stopp,mia pause"

# Audio output (optional)
MIA_AUDIO_SINK_ID="48"                     # fixiert default output device (wpctl status zeigt IDs)

# TTS
MIA_TTS_ENGINE="piper"                     # "piper" oder "xtts"
MIA_TTS_CHUNK_CHARS="180"
MIA_TTS_MAX_CHUNKS="8"
PIPER_MODEL="/data/mia/hear/piper/de/de_DE-kerstin-low.onnx"  # Kerstin Stimme
MIA_TTS_STREAM=1
MIA_TTS_STREAM_MIN_CHARS=80
MIA_TTS_STREAM_MAX_CHARS=180
MIA_TTS_ADAPTIVE_CHUNKING=1
MIA_TTS_PHASE1_SEC=1.2
MIA_TTS_PHASE2_SEC=3.5

# Intro-Filler für schnelle Erstreaktion
MIA_TTS_INTRO_ENABLE=1
MIA_TTS_INTRO_TEXTS="okay...,einen moment...,lass mich kurz nachdenken..."
MIA_TTS_INTRO_COOLDOWN_SEC=8

# Prefab Intro-Filler (WAV-basiert, dynamisch)
MIA_PREFAB_INTRO=1
MIA_PREFAB_DIR=/data/mia/repo_2/data/audio/prefabs
MIA_PREFAB_PROB=0.7
MIA_PREFAB_COOLDOWN_SEC=8

# Debug
MIA_DEBUG="1"                              # 1 = viele Logs (hilft beim Debuggen)
MIA_TRACE_TIMINGS=1

MIA_NUM_PREDICT=1200

export MIA_BARGEIN=1
export MIA_INTERRUPT_WORDS="mia stopp,stopp,mia warte,warte,mia pause,pause,mia halt,halt,mia ruhe,ruhe,mia stop bitte,stop bitte"
export MIA_AEC=0   # auf 1, wenn du Echo-Cancel sauber aktiv hast
export MIA_BARGEIN_MAX_SEC=3
export MIA_BARGEIN_SILENCE_SEC=0.35
export MIA_BARGEIN_MIN_SPEECH_SEC=0.12
export MIA_CHUNK_SEC=0.35
export MIA_SESSION_MODE=new
export MIA_TTS_COOLDOWN_MS=400

MIA_FORCE_ARECORD=1

export MIA_AUDIO_SOURCE_ID=52
